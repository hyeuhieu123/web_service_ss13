âŒ 1. TÃ¬nh huá»‘ng lá»—i phá»• biáº¿n cá»§a JWT
STT	TÃ¬nh huá»‘ng	MÃ´ táº£ lá»—i
1ï¸âƒ£	Thiáº¿u token	Client khÃ´ng gá»­i token
2ï¸âƒ£	Token khÃ´ng há»£p lá»‡	Token bá»‹ sá»­a, sai format, khÃ´ng verify Ä‘Æ°á»£c
3ï¸âƒ£	Token háº¿t háº¡n	TrÆ°á»ng exp nhá» hÆ¡n thá»i gian hiá»‡n táº¡i
4ï¸âƒ£	Token bá»‹ giáº£ máº¡o	Signature khÃ´ng Ä‘Ãºng (lÃ½ do: sai secret)
5ï¸âƒ£	Token bá»‹ revoke (thu há»“i)	Há»‡ thá»‘ng Ä‘Ã£ vÃ´ hiá»‡u hÃ³a (lÆ°u token ID trong blacklist)
6ï¸âƒ£	Token chÆ°a há»£p lá»‡ (nbf)	Token chÆ°a Ä‘áº¿n thá»i gian hiá»‡u lá»±c
7ï¸âƒ£	Sai audience (aud) hoáº·c issuer (iss)	KhÃ´ng khá»›p Ä‘á»‘i tÆ°á»£ng sá»­ dá»¥ng hoáº·c há»‡ thá»‘ng phÃ¡t hÃ nh
8ï¸âƒ£	Refresh token khÃ´ng há»£p lá»‡	Refresh token sai / Ä‘Ã£ háº¿t háº¡n / khÃ´ng Ä‘Ãºng vá»›i access token

ğŸ§¾ 2. VÃ­ dá»¥ JSON response khi server bÃ¡o lá»—i
1ï¸âƒ£ Token khÃ´ng há»£p lá»‡ (malformed, signature sai)
json
Copy
Edit
{
  "error": "INVALID_TOKEN",
  "message": "Token is invalid or has been tampered with",
  "code": 401
}
2ï¸âƒ£ Token háº¿t háº¡n
json
Copy
Edit
{
  "error": "TOKEN_EXPIRED",
  "message": "Token has expired",
  "code": 401
}
3ï¸âƒ£ KhÃ´ng gá»­i token
json
Copy
Edit
{
  "error": "MISSING_TOKEN",
  "message": "Authorization token is required",
  "code": 401
}
4ï¸âƒ£ Token bá»‹ revoke / khÃ´ng Ä‘Æ°á»£c phÃ©p
json
Copy
Edit
{
  "error": "UNAUTHORIZED",
  "message": "This token has been revoked or is no longer valid",
  "code": 401
}
ğŸ§­ 3. HÃ nh Ä‘á»™ng phÃ¹ há»£p phÃ­a client
TrÆ°á»ng há»£p	Gá»£i Ã½ xá»­ lÃ½ (client)
âŒ KhÃ´ng cÃ³ token	â†’ ThÃ´ng bÃ¡o: â€œBáº¡n chÆ°a Ä‘Äƒng nháº­pâ€ â†’ Redirect trang login
âŒ Token sai / giáº£ máº¡o	â†’ Logout ngay (xÃ³a token) â†’ ThÃ´ng bÃ¡o: â€œPhiÃªn Ä‘Äƒng nháº­p khÃ´ng há»£p lá»‡â€
âŒ Token háº¿t háº¡n	â†’ Gá»­i refresh token (náº¿u cÃ³) Ä‘á»ƒ láº¥y access token má»›i. Náº¿u khÃ´ng cÃ³ â†’ logout
âŒ Token bá»‹ thu há»“i	â†’ ThÃ´ng bÃ¡o: â€œBáº¡n Ä‘Ã£ Ä‘Äƒng xuáº¥t trÃªn thiáº¿t bá»‹ khÃ¡câ€ â†’ Logout
âŒ Token chÆ°a há»£p lá»‡ (nbf)	â†’ Thá»­ láº¡i sau vÃ i giÃ¢y
âŒ Token Ä‘Ãºng nhÆ°ng khÃ´ng cÃ³ quyá»n (403)	â†’ ThÃ´ng bÃ¡o: â€œBáº¡n khÃ´ng cÃ³ quyá»n truy cáº­p chá»©c nÄƒng nÃ yâ€

âœ… TÃ³m gá»n keyword dá»… nhá»›
Váº¥n Ä‘á»	Tá»« khÃ³a	HÃ nh Ä‘á»™ng
âŒ KhÃ´ng token	MISSING_TOKEN	ThÃ´ng bÃ¡o + Redirect login
âŒ Háº¿t háº¡n	TOKEN_EXPIRED	Refresh â†’ náº¿u fail thÃ¬ logout
âŒ Sá»­a token	INVALID_TOKEN	Logout + cáº£nh bÃ¡o
âŒ KhÃ´ng Ä‘Ãºng quyá»n	FORBIDDEN (403)	ThÃ´ng bÃ¡o â€œKhÃ´ng Ä‘á»§ quyá»nâ€
âŒ Bá»‹ revoke	REVOKED_TOKEN	Logout + thÃ´ng bÃ¡o báº£o máº­t